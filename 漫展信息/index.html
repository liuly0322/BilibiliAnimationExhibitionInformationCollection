<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bilibili Êº´Â±ï‰ø°ÊÅØÊî∂ÈõÜ</title>
    <script src="https://registry.npmmirror.com/vue/3.4.7/files/dist/vue.global.prod.js"></script>
  </head>
  <body>
    <style>
      a {
        color: black;
      }
      #auto-update-status,
      #city-select-div {
        margin-bottom: 1em;
      }
      details {
        border: 1px solid #ddd;
        padding: 0.5em;
        margin-bottom: 1em;
        background-color: #f9f9f9;
      }
      summary {
        font-weight: bold;
        margin: -0.5em -0.5em 0;
        padding: 0.5em;
      }
      details[open] {
        padding: 0.5em;
      }
      details[open] summary {
        border-bottom: 1px solid #ddd;
        margin-bottom: 0.5em;
      }
      /* wide screen mode */
      @media screen and (min-width: 600px) {
        #project-list {
          margin: 0 auto;
          overflow: hidden;
        }
        .project-list-item {
          position: relative;
          display: flex;
          cursor: pointer;
          margin-top: 60px;
          margin-right: 40px;
          width: 560px;
          height: 237px;
          background: #fff;
          box-shadow: 0 0 15px 0 hsla(203, 6%, 45%, 0.09);
          border-radius: 8px;
          float: left;
          transition: transform 0.2s;
        }
        #project-list .project-list-item:hover {
          box-shadow: 0 15px 20px 0 hsla(203, 6%, 45%, 0.4);
        }
        #project-list .project-list-item:hover .project-list-item-img {
          transform: translate3d(0, -10px, 0);
        }
        .project-list-item-img {
          transition: transform 0.1s;
          background: #fff;
          box-shadow: 3px 3px 2px 0 hsla(203, 6%, 45%, 0.3);
          border-radius: 8px;
          left: 20px;
          bottom: 24px;
          position: absolute;
          width: 175px;
          height: 233px;
          background-repeat: no-repeat;
          background-size: 100% 100%;
        }
        .project-list-item-detail {
          margin-left: 223px;
        }
        .project-list-item-title {
          overflow: hidden;
          text-overflow: ellipsis;
          display: -webkit-box;
          -webkit-line-clamp: 2;
          margin-top: 30px;
          width: 286px;
          height: 48px;
          font-size: 18px;
          color: #222;
          letter-spacing: 0;
          line-height: 24px;
        }
        .project-list-item-time,
        .project-list-item-time-detail,
        .project-list-item-address {
          margin-top: 19px;
          display: flex;
          align-items: center;
          height: 17px;
          font-size: 14px;
          color: #999;
        }
        .project-list-item-time-detail,
        .project-list-item-address {
          margin-top: 10px;
        }
        .project-list-item-price {
          display: flex;
          align-items: flex-end;
          margin-top: 13px;
          color: #f25d8e;
        }
        .project-list-item-price .price-symbol {
          align-self: flex-end;
          font-size: 18px;
          line-height: 18px;
        }
        .project-list-item-price .price {
          margin-left: 4px;
          font-size: 28px;
          letter-spacing: 1px;
          line-height: 24px;
        }
      }
      /* 2 tab */
      @media screen and (min-width: 1200px) {
        #project-list {
          width: 1160px;
        }
        #project-list .project-list-item:nth-child(2n) {
          margin-right: 0;
        }
      }
      /* 3 tab */
      @media screen and (min-width: 1800px) {
        #project-list {
          width: 1760px;
        }
        #project-list .project-list-item:nth-child(2n) {
          margin-right: 40px;
        }
        #project-list .project-list-item:nth-child(3n) {
          margin-right: 0;
        }
      }
      /* mobile */
      @media screen and (max-width: 600px) {
        body {
          margin: 0;
          padding: 0;
        }
        h1,
        p,
        #auto-update-status,
        #city-select-div {
          padding: 4px;
        }
        details {
          padding: 4px;
        }
        details[open] {
          padding: 4px 0;
        }
        summary {
          padding: 4px;
          margin: 0;
        }
        #project-list {
          background-color: #fff;
          padding: 3.2vw 4.26667vw 2.66667vw;
        }
        #project-list .project-list-item:not(:first-child) {
          margin-top: 9.6vw;
        }
        .project-list-item {
          display: flex;
        }
        .project-list-item-img {
          -webkit-box-flex: 0;
          background-size: 10.66667vw 10.66667vw;
          border-radius: 0.53333vw;
          -webkit-box-shadow: 0 1.33333vw 2.66667vw rgba(0, 0, 0, 0.1);
          box-shadow: 0 1.33333vw 2.66667vw rgba(0, 0, 0, 0.1);
          -ms-flex: 0 0 24vw;
          flex: 0 0 24vw;
          height: 32vw;
          position: relative;
          width: 24vw;
        }
        .project-list-item-detail {
          -webkit-box-flex: 1;
          -webkit-box-orient: vertical;
          -webkit-box-direction: normal;
          -webkit-box-align: stretch;
          -ms-flex-align: stretch;
          align-items: stretch;
          color: #212121;
          display: -webkit-box;
          display: -ms-flexbox;
          display: flex;
          -ms-flex: 1 1 auto;
          flex: 1 1 auto;
          -ms-flex-direction: column;
          flex-direction: column;
          overflow: hidden;
          padding-left: 3.2vw;
        }
        .project-list-item-title {
          -webkit-line-clamp: 2;
          -webkit-box-orient: vertical;
          color: #212121;
          display: -webkit-box;
          font-size: 4.26667vw;
          font-weight: 700;
          line-height: 5.06667vw;
          margin-bottom: 1.86667vw;
          max-height: 9.86667vw;
          overflow: hidden;
          position: relative;
        }
        .project-list-item-time {
          display: none;
        }
        .project-list-item-time-detail,
        .project-list-item-address {
          font-size: 3.2vw;
        }
        .project-list-item-price {
          color: #f25d8e;
          margin-top: auto;
        }
        .project-list-item-price .price {
          margin-left: 0.53333vw;
          font-size: 5.33333vw;
          font-weight: 700;
          line-height: 5.33333vw;
        }
      }
    </style>
    <h1>Bilibili Êº´Â±ï‰ø°ÊÅØÊî∂ÈõÜ</h1>

    <div id="auto-update-status">
      <span id="update_time"></span>Ôºà<a
        href="https://github.com/liuly0322/BilibiliAnimationExhibitionInformationCollection/actions/workflows/auto_update.yml"
        >GitHub Actions</a
      >Ôºâ
    </div>
    <script>
      fetch("timestamp.txt")
        .then((response) => response.text())
        .then((data) => {
          time = new Date(Number(data) * 1000).toLocaleString();
          document.getElementById(
            "update_time"
          ).innerHTML = `ÊúÄÂêéÊõ¥Êñ∞Êó∂Èó¥Ôºö${time}`;
        })
        .catch((error) => {
          document.getElementById(
            "update_time"
          ).innerHTML = `Error loading timestamp.txt: ${error}`;
        });
    </script>

    <div id="app">
      <div id="city-select-div">
        ÈÄâÊã©ÂüéÂ∏ÇÔºö<select v-model="citySelect">
          <option value="‰∏äÊµ∑">‰∏äÊµ∑</option>
          <option value="Êù≠Â∑û">Êù≠Â∑û</option>
          <option value="ËãèÂ∑û">ËãèÂ∑û</option>
          <option value="Âåó‰∫¨">Âåó‰∫¨</option>
          <option value="‰∏ΩÊ∞¥">‰∏ΩÊ∞¥</option>
          <option value="ÂπøÂ∑û">ÂπøÂ∑û</option>
          <option value="ÂêàËÇ•">ÂêàËÇ•</option>
          <option value="ÂçóÂÆÅ">ÂçóÂÆÅ</option>
        </select>
      </div>
      <div id="json-display">
        <details v-for="(value, key) in nonEmptyKindsExhibitions">
          <summary>{{ key }}</summary>
          <div id="project-list">
            <div
              v-for="item in value"
              class="project-list-item"
              @click="redirect(item)"
            >
              <div
                class="project-list-item-img"
                :style="{ backgroundImage: 'url(' + getCoverUrl(item.Cover) + ')' }"
              ></div>
              <div class="project-list-item-detail">
                <div class="project-list-item-title">{{ item.ÂêçÁß∞ }}</div>
                <div class="project-list-item-time">üìÖ {{ item.ÂºÄÂßãÊó∂Èó¥ }}</div>
                <div class="project-list-item-time-detail">
                  üïí {{ item.ÂÖ∑‰ΩìÊó∂Èó¥ËåÉÂõ¥ }}
                </div>
                <div class="project-list-item-address">üìç {{ item.Âú∞ÁÇπ }}</div>
                <div class="project-list-item-price">
                  <span class="price-symbol">¬•</span>
                  <span class="price">{{ item.ÊúÄ‰ΩéÁ•®‰ª∑ }}</span>
                </div>
              </div>
            </div>
          </div>
        </details>
      </div>
    </div>

    <script>
      const { createApp, ref, watch, onMounted, computed } = Vue;

      createApp({
        setup() {
          const citySelect = ref(
            localStorage.getItem("selectedCity") || "‰∏äÊµ∑"
          );
          const jsonDisplay = ref({});

          watch(citySelect, (newValue) => {
            localStorage.setItem("selectedCity", newValue);
            updateJson();
          });

          const updateJson = () => {
            jsonDisplay.value = {};
            const selectedCity = citySelect.value;
            const jsonFilePath = `${selectedCity}-Êº´Â±ï‰ø°ÊÅØ.json`;
            fetch(jsonFilePath)
              .then((response) => response.json())
              .then((data) => {
                jsonDisplay.value = data;
              })
              .catch((error) => {
                jsonDisplay.value = `Error loading data.json: ${error}`;
              });
          };

          const nonEmptyKindsExhibitions = computed(() => {
            const nonEmptyKindsExhibitions = {};
            for (const exhibitionKind in jsonDisplay.value) {
              const exhibitions = jsonDisplay.value[exhibitionKind];
              if (exhibitions.length > 0) {
                nonEmptyKindsExhibitions[exhibitionKind] = exhibitions;
              }
            }
            return nonEmptyKindsExhibitions;
          });

          onMounted(updateJson);

          const getCoverUrl = (url) => {
            return "https://api.liuly.moe/image/" + url;
          };

          const redirect = (item) => {
            window.open(item.Link);
          };

          return {
            citySelect,
            jsonDisplay,
            nonEmptyKindsExhibitions,
            getCoverUrl,
            redirect,
          };
        },
      }).mount("#app");
    </script>

    <script
      async
      src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"
    ></script>
    <p>
      <span id="busuanzi_container_page_pv">
        ÊÄªËÆøÈóÆÈáè <span id="busuanzi_value_page_pv"></span> Ê¨°
      </span>
    </p>
  </body>
</html>
